How to use UDF in JAVA?

Steps:
1) Create udf in java & build its jar.
2) Then add that jar using hive aux path setting into hive-site.xml file
such as,
    <property>
    <name>hive.aux.jars.path</name>
    <value>file:///C:\hdp\hive-0.14.0.2.2.0.0-2041\lib\hive-contrib-0.14.0.2.2.0.0-2041.jar</value>
    <description />
  </property>
  
  3) Create permanent function in hive using CREATE FUNCTION name_fun AS 'class.path.class_name'
  4) Call that function throgh java ui.
  
  Java Program to connect to hive.
  
  
  import java.sql.SQLException;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;
import java.sql.DriverManager;

import org.apache.hadoop.hive.cli.CliSessionState;
import org.apache.hadoop.hive.contrib.udf.UDFRowSequence;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.hive.conf.HiveConf;
import org.apache.hadoop.hive.ql.Driver;
import org.apache.hadoop.hive.ql.session.SessionState;

public class HiveJdbcClient {
	private static String driverName = "org.apache.hive.jdbc.HiveDriver";
	private static String databaseURL = "jdbc:hive2://192.168.20.247:10001/dtcc_poc";
	private static String userName = "hadoop";
	private static String password = "eclerx#123";
	private static Connection CreateNewConfiguration() {
		Connection con = null;
		try {
			Class.forName(driverName);
			con = DriverManager.getConnection(databaseURL, userName, password);	
		} catch (ClassNotFoundException | SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		System.out.println("Connected....");
		return con;
	} 
	public static void main(String[] args) throws SQLException {
		HiveConf hiveConf=new HiveConf(HiveJdbcClient.class);
		hiveConf.addResource(new Path("C:\\hdp\\hive-0.14.0.2.2.0.0-2041\\conf\\hive-site.xml"));
		hiveConf.setVar(HiveConf.ConfVars.HIVE_AUTHORIZATION_ENABLED,"true");
		
		Connection con = CreateNewConfiguration();
		DtccService dcs = new DtccService();

		int cycle_id=3;
		String tableName = "temp_dtcc_extract";

		int clientIdA = 1;
		int clientIdB = 2;
		String scenario = "Scenario-1";
		String mainTable = "dtcc_main_orc";
		String matchedtrades = "matchedtrades";

		// Insert data into main table 
//		if(dcs.insertIntoDTCCMain(con,cycle_id,tableName,mainTable))
//			System.out.println("Inserted Successfully into "+mainTable);

		// Insert records which is match on trade id
		if(dcs.insertIntoMatchedTrades(con, cycle_id, clientIdA, clientIdB, scenario, mainTable,matchedtrades))
			System.out.println("Inserted Successfully into "+matchedtrades);
	}
}

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;


public class DtccService {
	static int cnt = 0;
	Statement stmt=null;
	public int autoIncrement(){
		cnt++;
		return cnt;
	}

	public boolean insertIntoDTCCMain(Connection con,int cycleId,String tempTableName,String mainTable){

		DtccService dcs = new DtccService();
		String sql1 = "INSERT INTO TABLE dtcc_poc1."+mainTable+" "
				+ "PARTITION (intCycleId="+cycleId+", intClientId)"
				+ "SELECT row_sequence()AS inc,intDTCCID,intExtractID,intUserID,vcrRefIdentifier,"
				+ "intProductId,vcrRefProductName,vcrRefCPGroup,vcrRefCP,bitProcessed,dtmDateCreated,vcrTRADE_ID,"
				+ "vcrTRADE_ID2,vcrUNIQUE_REF,vcrSTATUS,vcrTREP_TRADING_DAY,vcrTREP_TRADING_TIME,"
				+ "vcrTREP_TRANSACTIONTYPE,vcrTREP_INSTRUMENT_CODE_TYPE,vcrTREP_INSTRUMENT_CODE,"
				+ "vcrTREP_COUNTERPARTY_CODE_TYPE,vcrTREP_COUNTERPARTY_CODE,vcrTREP_UNIT_PRICE,vcrTREP_CURRENCY,"
				+ "vcrTREP_QUANTITY,vcrTREP_TRADING_SEGMENT,vcrTRADING_DATEPOST,vcrTREP_UNIT_PRICE_NEW,null,intClientId "
				+ "FROM dtcc_poc."+tempTableName+" WHERE intClientId is not null";
		try {
			stmt = con.createStatement();
			System.out.println("Running: " + sql1);
			stmt.execute(sql1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return true;
	}
	public boolean insertIntoMatchedTrades(Connection con,int cycleId,int clientIdA,int clientIdB,String scenario, String mainTableName, String matchedtrades){
		String sql1 = "INSERT INTO TABLE dtcc_poc1."+matchedtrades+" "
				+ "SELECT A.intCycleId,A.intClientId,A.id,B.intCycleId,B.intClientId,B.id,'"+scenario+"'"
				+ "FROM	(Select * from "+mainTableName+" where intClientId="+clientIdA+" and intCycleId="+cycleId+") A "
				+ "JOIN (Select * from "+mainTableName+" where intClientId="+clientIdB+" and intCycleId="+cycleId+") B "
				+ "On A.vcrUNIQUE_REF=B.vcrUNIQUE_REF";
		try {
			stmt = con.createStatement();			
			System.out.println("Running: " + sql1);
			stmt.execute(sql1);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return true;
	}
}
  
