-- Reconcilation script 

SELECT A.id as intPartyTPID,
A.intDTCCID as intPartyADTCCID,
B.id as intPartyCPID,
B.intDTCCID as intPartyBDTCCID,
A.intcycleid,
A.vcrrefidentifier as vcrPartyATradeId,
B.vcrrefidentifier as vcrPartyBTradeId,
A.vcrTREP_COUNTERPARTY_CODE as vcrPartyACOUNTERPARTY_CODE, 
B.vcrTREP_COUNTERPARTY_CODE as vcrPartyACOUNTERPARTY_CODE,
A.vcrTREP_INSTRUMENT_CODE as vcrPartyAINSTRUMENT_CODE,
B.vcrTREP_INSTRUMENT_CODE as vcrPartyBINSTRUMENT_CODE,
A.vcrTREP_UNIT_PRICE as vcrPartyAUNIT_PRICE,
B.vcrTREP_UNIT_PRICE as vcrPartyBUNIT_PRICE,
A.vcrTREP_CURRENCY as vcrPartyACURRENCY,
B.vcrTREP_CURRENCY as vcrPartyBCURRENCY,
A.vcrTREP_QUANTITY as vcrPartyAQUANTITY,
B.vcrTREP_QUANTITY as vcrPartyBQUANTITY,
A.vcrTRADE_ID2 as vcrPartyATRADE_ID2,
B.vcrTRADE_ID2 as vcrPartyBTRADE_ID2,
A.vcrSTATUS as vcrPartyASTATUS,
B.vcrSTATUS as vcrPartyBSTATUS
FROM (Select * from dtcc_main_orc where  ismapped='true') A 
    	join 
   	(Select * from dtcc_main_orc d JOIN matchedtrades m ON d.id=m.cp_id) B 
		ON A.id=B.tp_id;
